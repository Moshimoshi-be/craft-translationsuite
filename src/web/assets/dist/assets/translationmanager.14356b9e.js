var e=Object.defineProperty,t=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,l=(e,l)=>{for(var i in l||(l={}))s.call(l,i)&&n(e,i,l[i]);if(t)for(var i of t(l))a.call(l,i)&&n(e,i,l[i]);return e};import{d as i,m as o,c as r,w as c,v as d,e as g,f as u,F as f,o as m,g as p,h,i as y,t as C,j as b,k as T,l as v,n as k,p as S,b as O,_ as x}from"./vendor.dbcbbd25.js";var w=i({data:()=>({}),computed:l({filter:{get(){return this.$store.state.filter},set(e){return this.$store.dispatch("setFilter",e.toLowerCase())}}},o(["translations","filteredTranslations","selectedCount","selectedCategory"])),methods:{filterResults(e){if(16==e.keyCode||17==e.keyCode||18==e.keyCode||20==e.keyCode||27==e.keyCode||37==e.keyCode||38==e.keyCode||39==e.keyCode||40==e.keyCode||91==e.keycode)return;console.log(this.filter);let t=[];console.log(this.translations),t=this.translations.filter((e=>{const t=e.languages;if(e.message.toLowerCase().includes(this.filter))return!0;for(const[s,a]of Object.entries(t)){if(a.db&&a.db.toLowerCase().includes(this.filter))return!0;if(a.file&&!a.db&&a.file.toLowerCase().includes(this.filter))return!0}return!1})),this.$store.commit("filterTranslations",t)},deleteSelectedTranslations(){this.$store.commit("deleteSelectedTranslations")},updateTranslations(){this.$store.commit("updateChangedTranslations")}},mounted(){console.log("Loaded")}});const L={class:"flex flex-grow texticon search icon clearable"},M=g("div",{class:"clear hidden",title:"Clear","aria-label":"Clear"},null,-1);w.render=function(e,t,s,a,n,l){return m(),r(f,null,[c(g("button",{onClick:t[1]||(t[1]=t=>e.deleteSelectedTranslations()),type:"button",class:"btn menubtn a-button--action","data-icon":"trash",title:"Actions",tabindex:"0"},null,512),[[d,e.selectedCount]]),g("div",L,[c(g("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.filter=t),onKeyup:t[3]||(t[3]=(...t)=>e.filterResults&&e.filterResults(...t)),type:"text",class:"text fullwidth",autocomplete:"off",placeholder:"Search","aria-label":"Search"},null,544),[[u,e.filter]]),M]),c(g("button",{onClick:t[4]||(t[4]=(...t)=>e.updateTranslations&&e.updateTranslations(...t)),class:"btn submit"},"Save",512),[[d,"add"!=e.selectedCategory]])],64)};var P=i({data:()=>({}),methods:l({uppercaseFirst:e=>e.charAt(0).toUpperCase()+e.slice(1)},p(["selectCategory"])),computed:l(l({},o(["categories","languages","missingTranslations","countMissingTranslations","selectedCategory"])),h(["getSelectedCategory"])),mounted(){console.log(this.categories)}});const A=g("span",{class:"label"},"Missing Translations",-1),$={class:"badge"},F=g("span",{class:"label"},"Add translation",-1),j=g("li",{class:"heading"},[g("span",null,"Categories")],-1),I={class:"label"};P.render=function(e,t,s,a,n,l){return m(),r("nav",null,[g("ul",null,[g("li",null,[g("a",{href:"#",onClick:t[1]||(t[1]=y((t=>e.selectCategory({category:"missing",refresh:!0})),["prevent"])),class:{sel:"missing"==e.selectedCategory}},[A,g("span",$,C(e.countMissingTranslations),1)],2)]),g("li",null,[g("a",{href:"#",onClick:t[2]||(t[2]=y((t=>e.selectCategory({category:"add"})),["prevent"])),class:{sel:"add"==e.selectedCategory}},[F],2)]),j,(m(!0),r(f,null,b(e.categories,((t,s)=>(m(),r("li",{key:s},[g("a",{href:"#",onClick:y((s=>e.selectCategory({category:t,refresh:!0})),["prevent"]),class:{sel:e.selectedCategory==t}},[g("span",I,C(e.$filters.ucFirst(t)),1)],10,["onClick"])])))),128))])])};const U=i({data:()=>({category:"",message:"",timeout:null}),computed:l({isFormDisabled(){return 0==this.categories.length||!this.category||!this.message}},o(["translations","filteredTranslations","languages","selectedCategory","categories","paginatorLimit","paginatorOffset"])),methods:{selectAll(e){const t=document.getElementById("selectAll"),s=!t.classList.contains("checked");t.classList.toggle("checked");for(let a of this.filteredTranslations)a.selected=s;s?this.$store.commit("setSelectedCount",this.filteredTranslations.length):this.$store.commit("setSelectedCount",0)},selectOne(e){e.selected=!e.selected,e.selected?(console.log("Incrementing"),this.$store.commit("incrementSelectedCount")):(console.log("Decrementing"),this.$store.commit("decrementSelectedCount"))},addSourceMessage(){const e={category:this.category,message:this.message};T.post("/admin/translationsuite/translations/add-source",e).then((e=>{"success"==e.data.message&&200===e.status&&(this.category="",this.message="",this.$store.commit("incrementMissingTranslations"),this.$toast.success("Added a new message"))}))},markAsChanged(e){clearTimeout(this.timeout),this.timeout=setTimeout((t=>{e.changed=!0}),100)}}}),R={class:"main"},D={class:"elements"},E={key:0,class:"flex flex-col justify-center items-start w-full xl:w-8/12"},K={class:"flex flex-nowrap mb-16 w-full"},V=g("label",{for:"category",class:"inline-block mr-8 min-w-48"},"Choose a category:",-1),N={class:"select w-full"},B=g("option",{disabled:"",value:""},"--- Select a category ---",-1),q={class:"flex flex-nowrap mb-16 w-full"},G=g("label",{for:"message",class:"inline-block mr-8 min-w-48"},"Message:",-1),H={class:"flex w-full justify-end mt-4"},Y={key:1,class:"tableview tablepane"},_={class:"data fullwidth"},z=g("div",{id:"selectAll",class:"checkbox"},null,-1),J={scope:"col","data-attribute":"category"},Q=g("th",{scope:"col","data-attribute":"message"},"Message",-1),W={class:"checkbox-cell"},X={class:"title"},Z={class:"max-w-40"},ee={class:"title"},te={class:"a-translation-field"};U.render=function(e,t,s,a,n,l){return m(),r("div",R,[g("div",D,["add"==e.selectedCategory?(m(),r("form",E,[g("div",K,[V,g("div",N,[c(g("select",{name:"category",class:"w-full","onUpdate:modelValue":t[1]||(t[1]=t=>e.category=t)},[B,(m(!0),r(f,null,b(e.categories,(e=>(m(),r("option",{value:e},C(this.$filters.ucFirst(e)),9,["value"])))),256))],512),[[v,e.category]])])]),g("div",q,[G,c(g("textarea",{name:"message",type:"text",rows:"3",class:"text w-full","onUpdate:modelValue":t[2]||(t[2]=t=>e.message=t)},null,512),[[u,e.message]])]),g("div",H,[g("input",{onClick:t[3]||(t[3]=y(((...t)=>e.addSourceMessage&&e.addSourceMessage(...t)),["prevent"])),disabled:e.isFormDisabled,class:[{disabled:e.isFormDisabled},"btn submit px-6"],type:"submit",value:"Add"},null,10,["disabled"])])])):(m(),r("div",Y,[g("table",_,[g("thead",null,[g("tr",null,[g("th",{onClick:t[4]||(t[4]=(...t)=>e.selectAll&&e.selectAll(...t)),class:"checkbox-cell selectallcontainer orderable",role:"checkbox",tabindex:"0","aria-checked":"false","aria-label":"Select all"},[z]),c(g("th",J,"Category",512),[[d,"missing"==e.selectedCategory]]),Q,(m(!0),r(f,null,b(e.languages,(e=>(m(),r("th",{scope:"col","data-attribute":"language-"+e.locale},C(e.name),9,["data-attribute"])))),256))])]),g("tbody",null,[(m(!0),r(f,null,b(e.filteredTranslations.slice(e.paginatorOffset,e.paginatorLimit),((t,s)=>(m(),r("tr",{key:"missing"==e.selectedCategory?"missing-"+s:t.category+"-"+s},[g("td",W,[g("div",{onClick:s=>e.selectOne(t),class:["checkbox",{checked:t.selected}],title:"Select","aria-label":"Select"},null,10,["onClick"])]),c(g("td",null,[g("span",X,C(t.category),1)],512),[[d,"missing"==e.selectedCategory]]),g("td",Z,[g("span",ee,C(t.message),1)]),(m(!0),r(f,null,b(t.languages,((a,n)=>(m(),r("td",{key:t.category+"-"+s+"-"+n},[g("div",te,[c(g("textarea",{onKeyup:s=>e.markAsChanged(t),"onUpdate:modelValue":e=>a.db=e,name:"translation-"+s+"-"+n,rows:"1",autocomplete:"off",class:"text w-full",placeholder:a.file},null,40,["onKeyup","onUpdate:modelValue","name","placeholder"]),[[u,a.db]]),g("label",{class:a.db?"type-db":a.file?"type-file":"type-missing"},C(a.db?"db":a.file?"file":"missing"),3)])])))),128))])))),128))])])]))])])};var se=i({data:()=>({}),computed:l({amountOfResults(){return this.filteredTranslations.length<this.paginatorLimit?this.filteredTranslations.length:this.paginatorLimit},amountOfTranslations(){return this.filteredTranslations.length}},o(["filteredTranslations","paginatorLimit","paginatorOffset","selectedCategory"])),methods:l({},p(["nextPageOfTranslations","previousPageOfTranslations"]))});const ae={key:0,id:"count-container",class:"light flex-grow"},ne={class:"flex pagination"},le={class:"page-info"};se.render=function(e,t,s,a,n,l){return"add"!=e.selectedCategory?(m(),r("div",ae,[g("div",ne,[g("div",{onClick:t[1]||(t[1]=(...t)=>e.previousPageOfTranslations&&e.previousPageOfTranslations(...t)),class:["page-link prev-page",{disabled:0==e.paginatorOffset}],title:"Previous Page"},null,2),g("div",{onClick:t[2]||(t[2]=(...t)=>e.nextPageOfTranslations&&e.nextPageOfTranslations(...t)),class:["page-link next-page",{disabled:e.paginatorOffset+e.paginatorLimit>=e.amountOfTranslations}],title:"Next Page"},null,2),g("div",le,C(e.paginatorOffset)+"-"+C(e.amountOfResults)+" of "+C(e.amountOfTranslations)+" entries",1)])])):k("",!0)};const ie=S({state:()=>({categories:[],selectedCategory:"missing",countMissingTranslations:0,missingTranslations:[],translations:[],filteredTranslations:[],paginatorLimit:10,paginatorStep:10,paginatorOffset:0,languages:[],filter:"",hasSelected:!1,selectedCount:0,isLoading:!1}),getters:{getSelectedCategory:e=>e.countMissingTranslations>0?"missing":e.categories[0]},mutations:{setInitialSelectedCategory(e){e.countMissingTranslations>0?e.selectedCategory="missing":e.selectedCategory=e.categories[0]},setCategories(e,t){e.categories=t},setLanguages(e,t){e.languages=t},setFilter(e,t){console.log("Set filter to",t),e.filter=t},setMissingTranslations(e,t){console.log("SETTING TRANSLATIONS",t),e.translations=t,e.filteredTranslations=e.translations,e.countMissingTranslations=t.length},incrementMissingTranslations(e){e.countMissingTranslations++},setTranslations(e,t){e.translations=t,e.filteredTranslations=t},setSelectedCount(e,t){e.selectedCount=t,console.log(e.selectedCount)},incrementSelectedCount(e){e.selectedCount++,console.log(e.selectedCount)},decrementSelectedCount(e){e.selectedCount--,console.log(e.selectedCount)},toggleHasSelected(e){e.hasSelected=!e.hasSelected},selectCategory(e,t){if(e.translations.filter((e=>e.changed)).length&&!confirm("You have unsaved translations, do you want to discard them?"))return;const s=t.refresh,a=t.category;e.selectedCategory=a,e.paginatorOffset=0,e.paginatorLimit=e.paginatorStep,e.filter="";const n=document.getElementById("selectAll");n&&n.classList.remove("checked"),s&&Promise.resolve(ie.dispatch("fetchTranslations",a)).then((t=>{e.translations=t,e.filteredTranslations=t,"missing"==a&&(e.countMissingTranslations=e.translations.length)}))},filterTranslations(e,t){e.filteredTranslations=t},nextPageOfTranslations(e){if(e.paginatorOffset+e.paginatorLimit>e.filteredTranslations.length)return!1;e.paginatorOffset+=e.paginatorStep,e.paginatorLimit=e.paginatorOffset+e.paginatorStep},previousPageOfTranslations(e){if(0==e.paginatorOffset)return!1;e.paginatorOffset-=e.paginatorStep,e.paginatorLimit=e.paginatorOffset+e.paginatorStep},deleteSelectedTranslations(e){const t=e.filteredTranslations.filter((e=>1==e.selected)),s=e.filteredTranslations.filter((e=>0==e.selected));"missing"==e.selectedCategory&&(e.countMissingTranslations=s.length);const a={translations:t};T.post("/admin/translationsuite/translations/delete-translations",a).then((s=>{e.translations=e.filteredTranslations=e.translations.filter((function(e){return oe.$toast.success("Successfully deleted!"),this.indexOf(e)<0}),t)}))},updateChangedTranslations(e){const t=e.translations.filter((e=>e.changed)),s={translations:t};T.post("/admin/translationsuite/translations/update-translations",s).then((e=>{for(let s of t)s.changed=!1;oe.$toast.success("Successfully translated!")})).catch((e=>{console.error(e)}))}},actions:{setFilter:({commit:e,state:t},s)=>(e("setFilter",s),t.filter),fetchTranslations:async(e,t)=>(await T.get("/admin/translationsuite/translations/get-translations/"+t)).data}}),oe=O(i({components:{toolbar:w,sidebar:P,manager:U,pagination:se},data:()=>({}),methods:{getCategories:async()=>(await T.get("/admin/translationsuite/translations/get-categories")).data,getLanguages:async()=>(await T.get("/admin/translationsuite/translations/get-languages")).data},mounted(){Promise.all([this.getCategories(),this.getLanguages(),ie.dispatch("fetchTranslations","missing")]).then((e=>{ie.commit("setCategories",e[0]),ie.commit("setLanguages",e[1]),ie.commit("setMissingTranslations",e[2]),ie.state.countMissingTranslations>0?ie.commit("selectCategory",{category:"missing"}):ie.commit("selectCategory",{category:ie.state.categories[0],refresh:!0})})),document.addEventListener("keydown",(e=>{const t=e.metaKey||e.ctrlKey,s="s"==e.key;t&&s&&(e.preventDefault(),ie.commit("updateChangedTranslations"))}))}}));oe.config.globalProperties.$filters={ucFirst:e=>e.charAt(0).toUpperCase()+e.slice(1)},oe.use(ie),oe.use(x,{position:"top-right",duration:2500,queue:!0}),oe.mount("#main");
//# sourceMappingURL=translationmanager.14356b9e.js.map
